[comment encoding = UTF-8 /]
[**
 * The documentation of the module generateNaturalType.
 */]
[module crofRoleTypeGen('platform:/resource/org.rosi.crom.metamodel/')]
[import org::rosi::crom::framework::generator::templates::main::generalQueries/]
[import org::rosi::crom::framework::generator::templates::main::generalTemplates/]
[import org::rosi::crom::framework::generator::templates::main::crofFulfillmentGen/]

[**
 * The documentation of the template aRoleTypeImplGen.
 * @param aNaturalType
 */]
[template public crofRoleTypeGen(aCompartmentType : CompartmentType, relations : Set(Relation))]
[for(ar:AbstractRole|aCompartmentType.parts.role)]
[if(ar.oclIsKindOf(RoleType))]
[roleTypeModelGen(ar.oclAsType(RoleType),relations)/]
[for(aType:Type|getPlayers(ar.oclAsType(RoleType),relations))]
[crofFulfillmentGen(aType,ar.oclAsType(RoleType))/]
[/for]
[elseif(ar.oclIsKindOf(RoleGroup))]
[let roleTypes:Set(RoleType)=getOwnedRoles(ar.oclAsType(RoleGroup))]
[for(aRoleType:RoleType|roleTypes)]
[roleTypeModelGen(aRoleType,relations)/]
[for(aType:Type|getPlayers(aRoleType,relations))]
[crofFulfillmentGen(aType,aRoleType)/]
[/for]
[/for]
[/let]
[else]
something wrong in rtModelGen.mtl line 21.
[/if]
[/for]
[/template]

[template private roleTypeModelGen(aRoleType : RoleType, relations : Set(Relation))]
[file (getFolderPath() +'/crof/Crof'+ aRoleType.name.toUpperFirst()+'.java', false, 'UTF-8')]
package [getPackagePath()/].crof;


public class Crof[aRoleType.name.toUpperFirst()/][createExtends(aRoleType,relations)/]{
	[crofFields(aRoleType.attributes)/]
	[crofProperties(aRoleType.attributes)/]
}
[/file]
[/template]

[template private createExtends(aRoleType : RoleType, relations : Set(Relation)) post(replaceAll('\n',''))]
[if(hasSuper(aRoleType,relations))]
[let superRoleType:RoleType=getSuper(aRoleType,relations)]
 extends Crof[superRoleType.name.toUpperFirst()/]
[/let]
[else]
[/if]
[/template]
